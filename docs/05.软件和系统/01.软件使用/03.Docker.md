---
title: Docker
date: 2021-03-25 16:10:58
permalink: /pages/a65c57/
categories:
  - 软件和系统
  - 软件使用
tags:
  - 
---


### docker的底层原理

Docker 采用了 C/S 架构，包括客户端和服务端。Docker 守护进程 （ Daemon ）作为服务端接受来自客户端的请求，并处理这些请求（创建、运行、分发容器）。

利用了linux的命名空间

深入可以参考：[Docker 核心技术与实现原理 - 面向信仰编程 (draveness.me)](https://draveness.me/docker/)

### 为啥docker比VM等虚拟机更快

1. docker有着比虚拟机更少的抽象层。由于docker不需要Hypervisor实现硬件资源虚拟化,运行在docker容器上的程序直接使用的都是实际物理机的硬件资源。因此在CPU、内存利用率上docker将会在效率上有明显优势
2. Docker利用的是宿主机的内核，而不需要Guest OS，因此，当新建一个容器时，Docker不需要和虚拟机一样重新加载一个操作系统，避免了引导、加载操作系统内核这个比较费时费资源的过程，当新建一个虚拟机时，虚拟机软件需要加载Guest OS，这个新建过程是分钟级别的，而Docker由于直接利用宿主机的操作系统则省略了这个过程，因此新建一个Docker容器只需要几秒钟
3. 使用了Hypervisor

[为什么Docker比VM等虚拟机快_花&败-CSDN博客](https://blog.csdn.net/K_520_W/article/details/111304146)

### Kubernetes和Docker到底有啥关系？

1. Docker是一个开源的应用容器引擎，开发者可以打包他们的应用及依赖到一个可移植的容器中，发布到流行的Linux机器上，也可实现虚拟化。
2. k8s是一个开源的容器集群管理系统，可以实现容器集群的自动化部署、自动扩缩容、维护等功能。

[最简明易懂的docker和k8s的关系 - bengozhong的个人空间 - OSCHINA - 中文开源技术交流社区](https://my.oschina.net/u/588516/blog/3069671)



### 如何实现资源隔离和权限控制

- 使用命名空间来实现隔离
- 启用了Mount Namespace，并将自己打包的文件系统挂载好，就可以实现每个容器仅看到自己的文件，实现文件资源的隔离。
- 如何实现CPU，内存等资源控制呢？使用Cgroups，这个可以实现对CPU资源控制

### docker有几种网络模式

-  **bridge模式** bridge模式是Docker默认的网络设置，此模式会为每一个容器分配Network Namespace、设置IP等，并将并将一个主机上的Docker容器连接到一个虚拟网桥上。
- **host模式** 如果启动容器的时候使用host模式，那么这个容器将不会获得一个独立的Network Namespace，而是和宿主机共用一个Network Namespace。容器将不会虚拟出自己的网卡，配置自己的IP等，而是使用宿主机的IP和端口。
- **none模式** 在none模式下，Docker容器拥有自己的Network Namespace，但是，并不为Docker容器进行任何网络配置。也就是说，这个Docker容器没有网卡、IP、路由等信息。需要我们自己为Docker容器添加网卡、配置IP等。
- **container模式** 这个模式指定新创建的容器和已经存在的一个容器共享一个Network Namespace，而不是和宿主机共享。新创建的容器不会创建自己的网卡，配置自己的IP，而是和一个指定的容器共享IP、端口范围等。同样，两个容器除了网络方面，其他的如文件系统、进程列表等还是隔离的。两个容器的进程可以通过lo网卡设备通信。

参考： [Docker的四种网络模式_huanongying123的专栏-CSDN博客_docker的网络模式](https://blog.csdn.net/huanongying123/article/details/73556634)

